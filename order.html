<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pizza Order - Choose & Quantity</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #fff8f0;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 1100px;
      margin: 50px auto;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #b5212e;
    }

    .pizza-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
    }

    .pizza-card {
      width: 200px;
      border: 1px solid #ddd;
      border-radius: 10px;
      text-align: center;
      background-color: white;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .pizza-card:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .pizza-card img {
      width: 100%;
      height: 140px;
      object-fit: cover;
      border-bottom: 1px solid #ddd;
    }

    .pizza-card h3 {
      margin: 10px 0 5px;
      padding: 5px;
      font-size: 18px;
      color: #333;
    }

    .desc {
      font-size: 13px;
      color: #777;
      margin: 5px 0;
    }

    .rating {
      color: #ffcc00;
      font-size: 14px;
    }

    .price-tag {
      color: #b5212e;
      font-weight: bold;
    }

    .quantity-label {
      font-weight: bold;
      font-size: 14px;
      color: #555;
    }

    .quantity-input {
      width: 60px;
      padding: 5px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
      text-align: center;
      margin: 5px auto;
      display: block;
    }

    .order-now-btn,
    .add-cart-btn {
      background-color: #0d1b2a;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      margin: 5px;
      width: 80%;
    }

    .order-now-btn:hover,
    .add-cart-btn:hover {
      background-color: #ffcc00;
      color: #0d1b2a;
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    #cart-section,
    #order-form {
      display: none;
      background: white;
      padding: 30px;
      margin-top: 40px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    label {
      font-weight: bold;
      display: block;
      margin: 15px 0 5px;
    }

    input,
    select,
    textarea,
    button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin-bottom: 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button[type="submit"] {
      background-color: #0d1b2a;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
    }

    button[type="submit"]:hover {
      background-color: #ffcc00;
      color: #0d1b2a;
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    nav {
      background-color: #b5212e;
      padding: 12px 10px;
      text-align: center;
    }

    nav a {
      color: white;
      margin: 0 12px;
      text-decoration: none;
      font-weight: bold;
      font-size: 15px;
      display: inline-block;
    }

    nav a:hover {
      text-decoration: underline;
    }

    img.logo {
      margin: -20px 13px;
      padding: 15px;
      float: left;
      height: 35px;
      border-radius: 45px;
    }

    #cartIcon {
      position: fixed;
      top: 52px;
      right: 25px;
      background-color: #0d1b2a;
      color: white;
      padding: 8px 14px;
      border-radius: 25px;
      font-weight: bold;
      cursor: pointer;
    }

    /* Cart Table Styling Fix */

    #cart-section table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 8px;
      margin-top: 15px;
      text-align: center;
    }

    #cart-section th,
    #cart-section td {
      padding: 10px;
      text-align: center;
      border: none;
    }

    #cart-section th {
      background-color: transparent;
      color: #333;
      font-weight: bold;
      font-size: 15px;
      border-bottom: 2px solid #b5212e33;
    }

    #cart-section tr {
      background-color: #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      border-radius: 10px;
    }

    #cart-section td:first-child {
      font-weight: 600;
      color: #b5212e;
    }

    #cart-section tr:hover {
      transform: scale(1.02);
      transition: 0.2s;
    }

    #cartIcon:hover {
      background-color: #ffcc00;
      color: #0d1b2a;
    }

    #searchBox {
      width: 50%;
      padding: 10px;
      margin: 20px auto;
      display: block;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    /* Modern Toast Notification */
    .toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(-20px);
      background: #0d1b2a;
      color: #fff;
      padding: 12px 25px;
      border-radius: 8px;
      opacity: 0;
      transition: opacity 0.5s, transform 0.5s;
      font-size: 15px;
      z-index: 9999;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }


    @media (max-width: 768px) {

      img.logo {
        height: 25px;
        margin: -10px 3px;

      }
      nav a {
        margin: 0 2px;
        padding: 5px 5px;
        font-size: 13px;
      }
      #cartIcon {
        top: 52px;
        right: 10px;
        padding: 6px 10px;
        font-size: 12px;
      }
      #searchBox {
        width: 90%;
      }
      nav {
        padding: 8px 5px;

      }
    }
  </style>
</head>

<body>
  <!-- Navigation -->
  <nav>
    <img src="photo/logo/logo.jpg" class="logo" alt="ANPI Logo">
    <a href="home.html">Home</a>
    <a href="menu.html">Menu</a>
    <a href="order.html">Order Now</a>
    <a href="about.html">About Us</a>
    <a href="home.html#gallery">Gallery</a>
    <a href="contact.html">Contact</a>
  </nav>

  <div id="cartIcon" onclick="showCart()">üõí <span id="cartCount">0</span></div>
  <div id="toast" class="toast"></div>

  <div class="container">
    <h1>üçï Choose Your Pizza</h1>
    <input type="text" id="searchBox" placeholder="Search your favorite pizza...">

    <div class="pizza-grid" id="pizzaGrid"></div>

    <!-- CART SECTION -->
    <div id="cart-section">
      <h2>Your Cart</h2>
      <table style="width:100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th>Pizza</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody id="cartTable"></tbody>
      </table>
      <h3 id="cartTotal"></h3>
      <button class="order-now-btn" onclick="proceedToCheckout()">Proceed to Checkout</button>
    </div>

    <!-- ORDER FORM -->
    <div id="order-form">
      <h2>Complete Your Order</h2>
      <form id="orderForm" onsubmit="goToPayment(event)">
        <label>Selected Pizza</label>
        <input type="text" id="selectedPizza" readonly />

        <label>Quantity</label>
        <input type="number" id="selectedQty" readonly />

        <label>Your Name</label>
        <input type="text" name="customer_name" required />

        <label>Phone Number</label>
        <input type="tel" name="phone" required pattern="[0-9]{10}" placeholder="10-digit number" />

        <label>Delivery Address</label>
        <textarea name="address" rows="3" required></textarea>

        <button type="submit">Place Order</button>
      </form>
    </div>
  </div>

  <script>
    const pizzas = [
      { name: "Margherita", img: "photo/order/margherita.jpg", price: 150, desc: "Classic delight with mozzarella & basil", rating: 4.8 },
      { name: "Pepperoni", img: "photo/order/pepperoni.jpg", price: 200, desc: "Loaded with pepperoni & cheese", rating: 4.9 },
      { name: "Veggie Delight", img: "photo/order/Veggie Delight.jpg", price: 180, desc: "Topped with fresh veggies and cheese", rating: 4.6 },
      { name: "BBQ Chicken", img: "photo/order/BBQ Chicken.jpg", price: 220, desc: "Smoky BBQ chicken and onions", rating: 4.7 },
      { name: "Four Cheese", img: "photo/order/Four Cheese.jpg", price: 210, desc: "Blend of mozzarella, cheddar, feta & parmesan", rating: 4.8 },
      { name: "Hawaiian", img: "photo/order/hawaiian.jpg", price: 190, desc: "Sweet pineapple & ham combo", rating: 4.5 },
      { name: "Paneer Tikka", img: "photo/order/Paneer Tikka.jpg", price: 240, desc: "Spicy Indian paneer flavor", rating: 4.9 },
      { name: "Mexican", img: "photo/order/Mexican.jpg", price: 230, desc: "Zesty peppers and Mexican herbs", rating: 4.7 },
    ];

    let cart = []; // Cart array to store selected items

    const pizzaGrid = document.getElementById('pizzaGrid');

    // --- 1. Pizza Rendering ---
    function renderPizzas() {
      pizzaGrid.innerHTML = "";
      pizzas.forEach(pizza => {
        const card = document.createElement('div');
        card.className = 'pizza-card';
        card.innerHTML = `
                <img src="${pizza.img}" alt="${pizza.name} Pizza" />
                <h3>${pizza.name}</h3>
                <p class="desc">${pizza.desc}</p>
                <p class="rating">‚≠ê ${pizza.rating}</p>
                <p class="price-tag">Price: ‚Çπ${pizza.price}</p>
                <label class="quantity-label">Quantity:</label>
                <input type="number" min="1" max="20" id="qty-${pizza.name.replace(/\s/g, '-')}" class="quantity-input" value="1" />
                <button class="add-cart-btn" onclick="addToCart('${pizza.name}')">Add to Cart</button>
                <button class="order-now-btn" onclick="quickOrder('${pizza.name}')">Order Now</button>
            `;
        pizzaGrid.appendChild(card);
      });
    }
    renderPizzas();

    // --- 2. Toast Notification ---
    function showToast(msg) {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }

    // --- 3. Add to Cart Logic ---
    function addToCart(name) {
      // Correctly get the quantity input element using a sanitized ID
      const qtyInputId = `qty-${name.replace(/\s/g, '-')}`;
      const qty = parseInt(document.getElementById(qtyInputId).value);

      if (qty <= 0) return showToast("Enter a valid quantity!");

      const pizza = pizzas.find(p => p.name === name);
      const existing = cart.find(i => i.name === name);

      if (existing) existing.qty += qty;
      else cart.push({ ...pizza, qty });

      updateCartCount();
      showToast(`${name} added to cart!`);
    }

    // --- 4. Quick Order Logic ---
    function quickOrder(name) {
      // Correctly get the quantity input element using a sanitized ID
      const qtyInputId = `qty-${name.replace(/\s/g, '-')}`;
      const qty = parseInt(document.getElementById(qtyInputId).value);

      if (qty <= 0) return showToast("Enter a valid quantity!");

      document.getElementById('selectedPizza').value = name;
      document.getElementById('selectedQty').value = qty;

      // Hide cart, show order form, and scroll
      document.getElementById('cart-section').style.display = 'none';
      document.getElementById('order-form').style.display = 'block';
      document.getElementById('order-form').scrollIntoView({ behavior: 'smooth' });
    }

    // --- 5. Cart Count Update ---
    function updateCartCount() {
      // The count is the number of unique items in the cart
      document.getElementById('cartCount').innerText = cart.length;
    }

    // --- 6. Show Cart Section ---
    function showCart() {
      if (cart.length === 0) return showToast("Your cart is empty!");

      const table = document.getElementById('cartTable');
      table.innerHTML = "";
      let total = 0;

      cart.forEach(item => {
        const subtotal = item.price * item.qty;
        total += subtotal;
        table.innerHTML += `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.qty}</td>
                    <td>‚Çπ${item.price}</td>
                    <td>‚Çπ${subtotal.toFixed(2)}</td>
                </tr>`;
      });

      document.getElementById('cartTotal').innerText = `Total: ‚Çπ${total.toFixed(2)}`;

      // Show cart section, hide order form, and scroll
      document.getElementById('cart-section').style.display = 'block';
      document.getElementById('order-form').style.display = 'none';
      document.getElementById('cart-section').scrollIntoView({ behavior: 'smooth' });
    }

    // --- 7. Proceed to Checkout (from Cart) ---
    function proceedToCheckout() {
      document.getElementById('cart-section').style.display = 'none';
      document.getElementById('order-form').style.display = 'block';
      document.getElementById('order-form').scrollIntoView({ behavior: 'smooth' });

      // Indicate a multi-item order for the checkout form
      document.getElementById('selectedPizza').value = "Multiple Items";
      document.getElementById('selectedQty').value = cart.reduce((sum, i) => sum + i.qty, 0); // Total quantity
    }

    // --- 8. Go to Payment (The Fix is here! üîë) ---
    function goToPayment(e) {
      e.preventDefault();
      let total = 0;

      // Determine total based on Quick Order or Cart Checkout
      if (document.getElementById('selectedPizza').value === "Multiple Items") {
        // Cart Checkout: Calculate total from cart array
        total = cart.reduce((sum, i) => sum + i.price * i.qty, 0);

        // Clear the cart after placing the multi-item order
        cart = [];
        updateCartCount();
      } else {
        // Quick Order: Calculate total from the two hidden fields
        const pizza = pizzas.find(p => p.name === document.getElementById('selectedPizza').value);
        const qty = parseInt(document.getElementById('selectedQty').value);
        total = pizza.price * qty;
      }

      localStorage.setItem("pizza_total_price", `‚Çπ${total.toFixed(2)}`);

      showToast("Order Placed. Redirecting to payment page...");
      setTimeout(() => (window.location.href = 'pay.html'), 1400);
    }

    // --- 9. Search Functionality ---
    document.getElementById('searchBox').addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase();
      document.querySelectorAll('.pizza-card').forEach(card => {
        // Check card text content for the search query
        card.style.display = card.innerText.toLowerCase().includes(query) ? "block" : "none";
      });
    });
  </script>
</body>

</html>